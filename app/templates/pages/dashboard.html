{% extends 'layout/base.html' %}
{% block content %}

<div class="container mt-3" id="dashboard">
    <section id="dashboard">
        <legend class="legend-border text-center">{{ session['username'] }}'s Dashboard</legend>

        <nav class="dash-nav">
            <ul class="dash-tabs">
                <li><a class="tab-item dropdown-toggle">Articles</a>
                    <ul class="tabs-dropdown">
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'articles')">My Articles</a>
                        </li>
                        <li><a class="tab-item tab-link" href="{{ url_for('add_article') }}">New Article</a></li>
                    </ul>
                </li>
                <li><a class="tab-item dropdown-toggle">Profile</a>
                    <ul class="tabs-dropdown">
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'profile')">My Profile</a>
                        </li>
                        {% if profile %}
                        <li><a class="tab-item tab-link"
                                href="{{ url_for('edit_profile', profile_id=profile._id) }}">Update profile</a></li>
                        <li><a class="tab-item tab-link" id="delete-profile-modal" data-toggle="modal"
                                data-target="#deleteProfile">Delete Profile
                            </a></li>
                        <!-- only visible if no profile was found matching the logged in user's user_id  -->
                        {% else %}
                        <li><a class="tab-item tab-link" href="{{ url_for('add_profile') }}">Add profile</a></li>
                        {% endif %}
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'snt_profile_msgs')">Sent
                                Profile
                                messages</a>
                        </li>
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'rcvd_profile_msgs')">Received
                                Profile
                                messages</a>
                        </li>
                        <li><a class="tab-item tab-link" href="{{ url_for('update_password') }}">Update password</a>
                        </li>
                        <li><a class="tab-item tab-link" href="{{ url_for('add_account_image') }}">Update Profile
                                Image</a>
                        </li>

                    </ul>
                </li>
                <li><a class="tab-item dropdown-toggle">Projects</a>
                    <ul class="tabs-dropdown">
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'projects')">My Projects</a>
                        </li>
                        <li><a class="tab-item tab-link" href="{{ url_for('add_project') }}">Add Project</a></li>
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'rcvd_project_msgs')">Received
                                Project
                                Messages</a></li>
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'snt_project_msgs')">Sent
                                Project
                                Messages</a></li>

                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'rcvd_pieces')">Received
                                Pieces</a></li>
                        <li><a class="tablink tab-item tab-link" onclick="openTab(event, 'snt_pieces')">Sent
                                Pieces</a></li>
                    </ul>
                </li>
            </ul>
            {% if user.profile_image %}
            {% for part in profile_image %}
            <div id="div-profile-image"><a class="navbar-image mr-4" href="{{ url_for('add_account_image') }}"><img
                        src="{{ url_for('static', filename='uploads/account_image/'+'part.image_file' ) }}"
                        alt="{{ part.image_file }}" width="50" height="50"></a>
            </div>
            {% endfor %}
            {% else %}
            <div id="div-profile-image"><a class="navbar-image mr-4" href="{{ url_for('add_account_image') }}"><img
                        src="{{ url_for('static', filename='uploads/accountimage/gear-avatar.png' ) }}"
                        alt="defualt-image" width="50" height="50"></a>
            </div>
            {% endif %}
        </nav>
        <!-- Delete Profile Modal -->
        <div class="modal fade" id="deleteProfile" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title" style="color:red;">WARNING</h4>
                    </div>
                    <div class="modal-body">
                        <p>This process is immediate and cannot be undone. Are you sure?</p>
                        <!-- Button to confirm delete article -->
                        <form action="{{ url_for('delete_profile', profile_id=profile._id) }}" method="post">
                            <input id="delete-profile-btn" class="btn btn-outline-primary btn-sm" type="submit"
                                value="Confirm Delete">
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-danger btn-sm" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- DASHBAORD TAB CONTENT -->
        <div id="dash-tabs">
            <!-- ARTICLE TAB CONTENT -->
            <div id="articles" class="tabcontent">
                <div class="container">
                    {% if articles %}
                    <div class="accordion">
                        {% for article in articles %}
                        <div class="accordion-label"><span class="title">
                                {{ article.title }}
                            </span><br><span class="secondary-title">{{ article.date.strftime('%d, %B %Y') }}</span>
                        </div>
                        <div class="accordion-content">
                            <div>
                                <a href="{{ url_for('edit_article', article_id=article._id) }}" type="button"
                                    class="btn btn-outline-primary btn-sm mt-1 mb-1">Edit</a>
                                <button class="btn btn-outline-danger btn-sm" type="button" id="delete-article-modal"
                                    data-toggle="modal" data-target="#deleteArticle">Delete
                                </button>
                                <!-- Modal -->
                                <div class="modal fade" id="deleteArticle" role="dialog">
                                    <div class="modal-dialog">
                                        <!-- Modal content-->
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close"
                                                    data-dismiss="modal">&times;</button>
                                                <h4 class="modal-title" style="color:red;">WARNING</h4>
                                            </div>
                                            <div class="modal-body">
                                                <p>This process is immediate and cannot be undone. Are you sure?</p>
                                                <!-- Button to confirm delete article -->
                                                <form action="{{ url_for('delete_article', article_id=article._id) }}"
                                                    method="post">
                                                    <input class="btn btn-outline-primary btn-sm" type="submit"
                                                        value="Confirm Delete">
                                                </form>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-outline-danger btn-sm"
                                                    data-dismiss="modal">Cancel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>{{ article.content|safe }}</div>
                            <div>
                                <div id="dash-article-comments">
                                    <ul><span class="comments">Comments: </span>
                                        {% if article.comments %}
                                        {% for comment in article.comments %}
                                        <li class="secondary-title">On {{ comment.date.strftime('%d, %B %Y') }},
                                            {{ comment.username }}
                                            wrote: <br>
                                            <p>{{ comment.text }}</p>
                                        </li>
                                        {% if not loop.last %}
                                        <hr>
                                        {% endif %}
                                        {% endfor %}
                                    </ul>
                                    {% else %}
                                    <p>There are no comments on this post.</p>
                                    {% endif %}
                                    <div>
                                        <button id="dash-comment-btn{{ loop.index }}"
                                            class="comment-btn btn btn-outline-secondary btn-sm mb-1"
                                            type="button">Close</button>
                                        <div class="form-box show">
                                            <div class="form-group">
                                                <form action="{{ url_for('add_comment', article_id=article._id) }}"
                                                    method="post">
                                                    <div class="form-group">
                                                        <textarea class="form-control mt-2" name="comment"
                                                            id="comment{{ loop.index }}" rows="2" required></textarea>
                                                    </div>
                                                    <button type="submit"
                                                        class="btn btn-outline-primary btn-sm mt-1 mb-1">Post
                                                        comment</button>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% if not loop.last %}
                        <hr>
                        {% endif %}
                        {% endfor %}
                        {% else %}
                        <div class="col-sm-12 text-center">
                            <p>Your blog articles will appear here.</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            <!-- /END OF ARTICLE TAB CONTENT -->

            <!-- PROFILE TAB CONTENT -->
            <!-- Profile  -->
            <div id="profile" class="tabcontent">
                <div class="container">
                    {% if profile %}
                    <div class="row">
                        <div class="col-12 secondary-title text-center mt-2">
                            <p>Last updated: {{ profile.date.strftime('%d, %B %Y') }}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <ul>Headline:
                                <li>{{ profile.headline }}</li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <ul>Bio:
                                <li>{{ profile.bio|safe }}</li>
                            </ul>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-4">
                            <ul>Languages:
                                {% for lang in profile.languages %}
                                <li>{{ lang }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="col-sm-4">
                            <ul>Frameworks:
                                {% for item in profile.frameworks %}
                                <li>{{ item }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="col-sm-4">
                            <ul>Links:
                                {% for link in profile.personal_links %}
                                {% for key, value in link.items() %}
                                <li>{{ key }}: {{ value }}</li>
                                {% endfor %}
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    {% else %}
                    <div class="col-sm-12 text-center">
                        <p>If you create a profile it will appear here.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
            <!-- End of Profile -->

            <!-- Received Profile Messages -->
            <div id="rcvd_profile_msgs" class="tabcontent">
                <div class="container">
                    {% if rcvd_profile_msgs %}
                    <h5>Received Profile Messages</h5>
                    <hr>
                    {% for message in rcvd_profile_msgs %}
                    <ul>
                        <li>On {{ message.date.strftime('%d, %B %Y') }}, {{ message.from_user }} wrote: <br>
                            {{ message.text }}
                        </li>
                        {% if not loop.last %}
                        <hr>
                        {% endif %}
                    </ul>
                    {% endfor %}
                    {% else %}
                    <p class="text-center">You haven't received any profile messages yet.</p>
                    {% endif %}
                </div>
            </div>
            <!-- Sent Profile Messages -->
            <div id="snt_profile_msgs" class="tabcontent">
                <div class="container">
                    {% if snt_profile_msgs %}
                    <h5>Sent Profile Messages</h5>
                    <hr>
                    {% for message in snt_profile_msgs %}
                    <ul>
                        <li>On {{ message.date.strftime('%d, %B %Y') }}, you wrote to {{ message.to_user }}: <br>
                            {{ message.text }}
                        </li>
                        {% if not loop.last %}
                        <hr>
                        {% endif %}

                    </ul>
                    {% endfor %}
                    {% else %}
                    <p class="text-center">You haven't sent any profile messages yet.</p>
                    {% endif %}
                </div>
            </div>
            <!-- /End of Sent Profile Messages -->
            <!-- /END OF PROFILE MESSAGES -->
            <!-- /END OF PROFILE TAB CONTENT -->

            <!-- PROJECT TAB CONTENT -->
            <!-- Projects  -->
            <div id="projects" class="tabcontent">
                <div class="container">
                    {% if  projects %}
                    {% for project in projects %}
                    <div class="accordion">
                        <div id="project-accordion" class="accordion-label"><span class="title">
                                {{ project.title }}</span><br>
                            <span secondary-title>Post date:
                                {{ project.date.strftime('%d %B, %Y') }}</span>
                        </div>
                        <div class="accordion-content">
                            <a href="{{ url_for('add_piece', project_id=project._id) }}" id="project-btn-piece"
                                type="button" class="btn btn-outline-info btn-sm mb-1">Add piece</a>
                            <a href="{{ url_for('edit_project', project_id=project._id) }}"
                                id="project-btn-edit{{ loop.index }}" type="button"
                                class="btn btn-outline-primary btn-sm mb-1">Edit</a>
                            <button class="btn btn-outline-danger btn-sm mb-1" type="button"
                                id="delete-project-modal{{ loop.index }}" data-toggle="modal"
                                data-target="#deleteProject">Delete
                            </button>
                            <!-- Modal to Delete Project -->
                            <div class="modal fade" id="deleteProject{{ loop.index }}" role="dialog">
                                <div class="modal-dialog">
                                    <!-- Modal content-->
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                            <h4 class="modal-title" style="color:red;">WARNING</h4>
                                        </div>
                                        <div class="modal-body">
                                            <p>This process is immediate and cannot be undone. Are you sure?</p>
                                            <!-- Button to confirm delete project -->
                                            <form action="{{ url_for('delete_project', project_id=project._id) }}"
                                                method="post">
                                                <input id="delete-project-btn{{ loop.index }}"
                                                    class="btn btn-outline-success btn-sm" type="submit"
                                                    value="Confirm Delete">
                                            </form>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-outline-danger btn-sm"
                                                data-dismiss="modal">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <p>Current status: {{ project.status }}</p>
                            </div>
                            <div>
                                <p>Project deadline: {{ project.deadline.strftime('%d %B, %Y') }}</p>
                            </div>
                            <div>
                                <p>Project description: {{ project.brief|safe }}</p>
                            </div>
                            <div>
                                <p>Project files:
                                    {% if project.file_upload %}
                                    {{ project.file_upload }}
                                    {% else %}
                                    No File uploads for this project.
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        {% if not loop.last %}
                        <hr>
                        {% endif %}
                        {% endfor %}
                        {% else %}
                        <div class="col-sm-12 text-center">
                            <p>Your projects will appear here.</p>
                        </div>
                        {% endif %}
                    </div>
                </div>
                <!-- End of Projects -->
            </div>


            <!-- Project Messages -->
            <!-- Received Project Messages -->
            <div id="rcvd_project_msgs" class="tabcontent">
                <div class="container">
                    {% if rcvd_project_msgs %}
                    <ul>
                        <h5>Received Project Messages</h5>
                        <hr>
                        {% for message in rcvd_project_msgs %}
                        <li>On {{ message.date.strftime('%d, %B %Y') }}, {{ message.from_user }} wrote: <br>
                            {{ message.text }}
                        </li>
                        {% if not loop.last %}
                        <hr>
                        {% endif %}
                    </ul>
                    {% endfor %}

                    {% else %}
                    <p class="text-center">You haven't received any project messages yet.</p>
                    {% endif %}
                </div>
            </div>
            <!-- Sent Project Messages -->
            <div id="snt_project_msgs" class="tabcontent">
                <div class="container">
                    {% if snt_project_msgs %}
                    <ul>
                        <h5>Sent Project Messages</h5>
                        <hr>
                        {% for message in snt_project_msgs %}
                        <li>On {{ message.date.strftime('%d, %B %Y') }}, you wrote to {{ message.to_user }}: <br>
                            {{ message.text }}
                        </li>
                        {% if not loop.last %}
                        <hr>
                        {% endif %}
                        {% endfor %}
                    </ul>
                    {% else %}
                    <p class="text-center">You have not sent any project messages yet.</p>
                    {% endif %}
                </div>
            </div>
            <!-- /End of Sent Project Messages -->
            <!-- /End of Project Messages -->

            <!-- PROJECT PIECES -->
            <!-- Sent Pieces -->
            <div id="snt_pieces" class="tabcontent">
                <div class="container mt-2">
                    {% if snt_pieces|length > 0 %}{# outer if else collection not empty check #}
                    <h4>You currently have these active pieces</h4>

                    <!-- sent new not yet accepted -->
                    {% for piece in snt_pieces %} {# outer for loop #}
                    <div class="mt-3 mb-2">

                        {% if piece.status == "pending acceptance" %}{# pending approval status inner if elif check #}
                        <h5>New Pieces</h5>
                        <p><small><em>These pieces are not yet accepted. When your collaborator accepts them they
                                    undertake
                                    to start working on them.</em></small></p>
                    </div>
                    <hr>
                    <div class="mb-2 border-bottom">
                        <ul>
                            <li>
                                <p>You sent a project piece to {{ piece.assignee }}, on
                                    {{ piece.date.strftime('%d %B, %Y') }}.</p>
                                <p><span class='field'>'{{ piece.project_title }}'</span></p>
                                <p><span class='field'>Task name:</span> {{ piece.task }}</p>
                                <p><span class="field">Due date:</span> {{ piece.due_date.strftime('%d %B, %Y') }}
                                </p>
                                <p><span class='field'>Task Brief: </span> <br>
                                    You provided the following brief and information regarding your
                                    expectations for this piece:<br>
                                    {{ piece.description }}
                                </p>
                                <div><small class="text-muted">
                                        <i><a class="ml-2" href="#">Do you want to send a message to
                                                {{ piece.assignee }}?</a></i>
                                    </small></div>
                                {% if not loop.last %}
                                <hr>
                                {% endif %}
                            </li>
                        </ul>
                    </div>

                    <!-- sent and accepted -->
                    <div class="mt-3 mb-2">
                        {% elif piece.status == "accepted" %}{# accepted status inner if elif check #}
                        <h5>Accepted Pieces</h5>
                        <p>
                            <small><em>These pieces have been accepted indicating that your collaborator is preparing to
                                    commence work on them.</em></small>
                        </p>
                    </div>
                    <hr>

                    <div class="mb-2 border-bottom">
                        <ul>
                            <li>
                                <p>{{ piece.assignee }} has accepted a piece of your project assigned on
                                    {{ piece.date.strftime('%d %B, %Y') }}</p>
                                </p>
                                <p><span class="field">'{{ piece.project_title }}'</span></p>
                                <p><span class='field'>Due date:
                                    </span>{{ piece.due_date.strftime('%d %B, %Y') }}
                                </p>
                                <p><span class='field'>Task name: </span>{{ piece.task }}</p>
                                <p><span class='field'>Task Brief: </span>As a reminder, here is the brief and
                                    information provided:<br>
                                    {{ piece.description }}</p>
                                <div>
                                    <small class="text-muted">
                                        <i><a class="ml-2" href="#">Do you want to send a message to
                                                {{ piece.assignee }}?</a></i></small>
                                </div>
                                {% if not loop.last %}
                                <hr>
                                {% endif %}
                            </li>
                        </ul>
                    </div>


                    <!-- sent submitted -->
                    <div class="mt-3 mb-2">
                        {% elif piece.status == "pending approval" %}{# pending approval status inner if elif check #}

                        <h5>Pieces submitted for approval</h5>

                        <p><small><em>These pieces have been submitted and your collaborators are waiting for you to
                                    approve them. If you are happy to accept them, change the status to 'Closed'. If
                                    there is still work needed to complete the piece you can uodate the status back
                                    to 'Accepted', for work can continue.
                                    Ensure you update the brief so that the collaborator is aware of what is still
                                    required.</em></small>
                        </p>
                    </div>
                    <hr>

                    <div class="mb-2 border-bottom">
                        <ul>
                            <li>
                                <p>{{ piece.assignee }} has submitted a piece for your project.</p>
                                <p><span class="field">'{{ piece.project_title }}'</span></p>
                                <p><span class='field'>Due date:
                                    </span>{{ piece.due_date.strftime('%d %B, %Y') }}
                                </p>
                                <p><span class='field'>Task name: </span>{{ piece.task }}</p>
                                <p><span class='field'>Submitted:
                                    </span>{{ piece.submit_date.strftime('%d %B, %Y') }}</p>
                                <p><span class='field'>Task Brief: </span><br>
                                    As a reminder, here is the brief and
                                    information provided:<br>
                                    {{ piece.description }}</p>
                                <div>
                                    <a href="#" id="accept-piece-btn{{ loop.index }}" type="button"
                                        class="btn btn-outline-primary btn-sm mb-1">Approve</a>
                                    <a href="#" id="update-piece-btn{{ loop.index }}" type="button"
                                        class="btn btn-outline-primary btn-sm mb-1">Update</a>
                                    {% if not loop.last %}
                                    <hr>
                                    {% endif %}
                            </li>
                        </ul>
                    </div>


                    <!-- sent closed -->
                    <div class="mt-3 mb-2">
                        {% elif piece.status == "closed" %}{# closed status inner if elif check #}
                        <h5>Completed Pieces </h5>

                        <p><small><em>Great! you have closed these pieces inidicating that you have accepted
                                    the submission. As they are closed they will expire soon. Be
                                    sure to send feedback to the collaborator to help them understand how they did (e.g
                                    what they did well and areas you recimmend focussing on). It would be helpful to let
                                    them know what changes (if any) you made to their
                                    code so that they have an opportunity to learn from you.</em></small></p>
                    </div>
                    <hr>

                    <div class="mb-2 border-bottom">
                        <ul>
                            <li>
                                <p>You accepted a piece submited by {{ piece.assignee }} that was assigned on
                                    {{ piece.date.strftime('%d %B, %Y') }}</p>
                                <p><span class="field">'{{ piece.project_title }}'</span></p>
                                <p><span class='field'>Task name: </span>{{ piece.task }}</p>
                                <p><span class='field'>Submitted:
                                    </span>{{ piece.submit_date.strftime('%d %B, %Y') }}</p>
                                <p><span class='field'>Task Brief: </span><br>
                                    As a reminder, here is the brief and
                                    information provided:<br>
                                    {{ piece.description }}</p>

                                <div><small class="text-muted">
                                        <i><a class="ml-2" href="#">Send feedback to {{ piece.assignee }}
                                                about
                                                their work on this
                                                piece.</a></i>{# TODO add link to user profile #}
                                    </small></div>
                                {% if not loop.last %}
                                <hr>
                                {% endif %}
                            </li>
                        </ul>
                    </div>
                    {% endif %} {# inner if elif status check #}
                    {% endfor %} {# outer for loop #}

                    <div class="mb-2">
                        {% else %} {# outer if check else clause that should run if the collection if empty #}
                        <p class="text-center">Your project pieces will appear here when you create and to a
                            collaborator. Post your projects so that collaborators looking for them.
                            Members that are interested will send you a direct message about the project. You can
                            keep track of any messages you have received under your
                            <a href="#rcd_project_msgs">Projects > Recieved Project Messages</a> tab.</p>
                        {% endif %} {# outer if collection not empty check #}
                    </div>
                </div>
            </div>
        </div>
        <!-- /END OF SENT PIECES TAB-->


        <!-- RECEIVED PIECES TAB -->
        <div id="rcvd_pieces" class="tabcontent">
            <div class="container">
                {% if rcvd_pieces|length > 0 %}{# outer if collection not empty check #}
                <h4>You have currently have these project pieces</h4>

                <!-- received new not yet accepted -->
                {% for piece in rcvd_pieces %}{# outer for loop #}
                <div class="mt-3 mb-2">
                    {% if piece.status == "pending acceptance" %}{# pending approval status inner if elif check #}
                    <h5>New Pieces</h5>
                    <p><small><em>These pieces are not yet accepted. Accept them to let the owner know you intend to
                                start work on them. When you accept a piece you need to be committed to working on
                                it and be mindful of submitting it withing the due date.</em></small></p>
                </div>
                <hr>
                <div class="mb-2 border-bottom">
                    <ul>
                        <li>
                            <p>{{ piece.owner }} sent you a piece of the their project on
                                {{ piece.date.strftime('%d %B, %Y') }}</p>
                            <p><span class='field'>'{{ piece.project_title }}'</span></p>
                            <p><span class='field'>Task name:</span> {{ piece.task }}</p>
                            <p><span class="field">Due date:</span> {{ piece.due_date.strftime('%d %B, %Y') }}</p>
                            <p><span class='field'>Task Brief: </span> <br>
                                {{ piece.owner }} has provided the following brief and information regarding
                                their
                                expectations for this piece: <br>
                                {{ piece.description }}
                            </p>
                            <a href="#" id="accept-piece-btn{{ loop.index }}" type="button"
                                class="btn btn-outline-primary btn-sm mb-1">Accept Now</a>
                            <div><small class="text-muted">
                                    <i><a class="ml-2" href="#">Ask {{ piece.owner }} a question?</a></i>
                                </small></div>
                            {% if not loop.last %}
                            <hr>
                            {% endif %}
                        </li>
                    </ul>
                </div>


                <!-- received accepted -->
                <div class="mt-3 mb-2">
                    {% elif piece.status == "accepted" %}{# accepted status inner if elif check #}
                    <h5>Accepted Pieces</h5>
                    <p><small><em>You have accepted these pieces so the owner is waiting for you to submit
                                them.</em></small></p>
                </div>
                <hr>
                <div class="mb-2 border-bottom">
                    {% for piece in rcvd_pieces %}{# accepted status forloop #}
                    <ul>
                        <li>
                            <p>You have accepted this piece from {{ piece.owner }}.</p>
                            <p><span class='field'>'{{ piece.project_title }}'</span></p>
                            <p><span class='field'>Task name:</span> {{ piece.task }}</p>
                            <p><span class="field">Due date:</span> {{ piece.due_date.strftime('%d %B, %Y') }}
                            </p>
                            <p><span class='field'>Task Brief: </span> </p>
                            <p>As a reminder, here is the brief and information provided for
                                the piece: <br>
                                {{ piece.description }}
                            </p>
                            <a href="#" id="accept-piece-btn{{ loop.index }}" type="button"
                                class="btn btn-outline-primary btn-sm mb-1">Submit Now</a>
                            <div><small class="text-muted">
                                    <i><a class="ml-2" href="#">Ask {{ piece.owner }} a question about the
                                            task</a></i></small></div>
                            {% if not loop.last %}
                            <hr>
                            {% endif %}
                        </li>
                    </ul>
                    {% endfor %}{# accepted status endfor #}
                </div>


                <!-- received and submitted -->
                <div class="mt-3 mb-2">
                    {% elif piece.status == "pending approval" %}{# pending approval status inner if elif check #}
                    <h5>Pieces submitted for approval</h5>
                    <p><small><em>As these pieces are accepted by the owner they will move to the 'closed'
                                section for a short while for your reference. If there is still work to be done they
                                will move back to the accepted section for you to continue working on
                                them.</em></small>
                    </p>
                </div>
                <hr>
                <div class="mb-2 border-bottom">
                    <ul>
                        <li>
                            <p>You have submitted this piece for approval.</p>
                            <p><span class="field">'{{ piece.project_title }}'</span></p>
                            <p><span class='field'>Due date:
                                </span>{{ piece.due_date.strftime('%d %B, %Y') }}
                            </p>
                            <p><span class='field'>Task name: </span>{{ piece.task }}</p>
                            <p><span class='field'>Submitted on:
                                </span>{{ piece.submit_date.strftime('%d %B, %Y') }}</p>
                            <p><span class='field'>Task Brief: </span><br>
                                As a reminder, here is the brief and
                                information that was provided:<br>
                                {{ piece.description }}</p>


                            <div><small class="text-muted">
                                    <i><a class="ml-2" href="#">Do you have a question for {{ piece.owner }} about
                                            this piece?</a></i></small></div>
                            {% if not loop.last %}
                            <hr>
                            {% endif %}
                        </li>
                    </ul>
                </div>


                <!-- received and closed -->
                <div class="mt-3 mb-2">
                    {% elif piece.status == "closed" %}{# closed status inner if elif check #}
                    <h5>Completed Pieces </h5>
                    <p><small><em></em></small>Great! These pieces have been accepted and are closed; they
                        will expire soon. Be sure to ask for feedback from the owner.</p>
                </div>
                <hr>
                <div class="mb-2 border-bottom">
                    <ul>
                        <li>
                            <p>Awesome! {{ piece.owner }} has accepted this piece!</p>
                            <p><span class="field">'{{ piece.project_title }}'</span></p>
                            <p><span class='field'>Task name: </span>{{ piece.task }}</p>
                            <p><span class='field'>Submitted:
                                </span>{{ piece.submit_date.strftime('%d %B, %Y') }}</p>
                            <p><span class='field'>Task Brief: </span><br>
                                As a reminder, here is the brief and
                                information that was provided:<br>
                                {{ piece.description }}</p>

                            <div><small class="text-muted">
                                    <i><a class="ml-2" href="#">You can ask for feedback on your work
                                            here.</a></i></small></div>
                            {% if not loop.last %}
                            <hr>
                            {% endif %}
                        </li>
                    </ul>
                </div>
                {% endif %} {# inner if elif status check #}
                {% endfor %} {# outer for loop #}
                <div class="mb-2">
                    {% else %}{# outer if check else clause that should run if the collection if empty #}
                    <div class="text-center">
                        <p>Your project pieces will appear here when you receive them. If you see a
                            project that you are interested in collaborating on, let the owner know by sending them
                            a
                            direct
                            message via the projects page. You can keep track of any messages you have sent under
                            your
                            <a href="#snt_project_msgs">Projects > Sent Project Messages</a> tab.</p>
                    </div>
                </div>
                {% endif %} {# outer if collection not empty check #}
            </div>
        </div>
        <!-- /End of Received Pieces -->
        <!-- /END OF PIECES -->
        <!-- /END OF PROJECT TAB CONTENT -->
        <!-- /END TAB CONTENT -->
</div>
</section>
</div>
{% endblock content %}